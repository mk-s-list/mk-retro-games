<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Neon Tetris</title>
<style>
body{
  background:black;
  color:#00ffff;
  text-align:center;
  font-family:monospace;
}
canvas{
  background:#000;
  box-shadow:0 0 20px #00ffff;
  margin-top:10px;
}
button{
  font-size:22px;
  margin:6px;
  padding:10px 16px;
  border:none;
  border-radius:8px;
  background:#00ffff;
  color:black;
}
</style>
</head>
<body>

<h2>Neon Tetris</h2>
<canvas id="tetris" width="240" height="400"></canvas>

<div>
  <button onclick="move(-1)">‚¨ÖÔ∏è</button>
  <button onclick="rotate()">üîÑ</button>
  <button onclick="move(1)">‚û°Ô∏è</button><br>
  <button onclick="drop()">‚¨áÔ∏è</button>
</div>

<script>
const canvas = document.getElementById("tetris");
const ctx = canvas.getContext("2d");
ctx.scale(20,20);

const arena = Array.from({length:20},()=>Array(12).fill(0));

const pieces = [
 [[1,1,1,1]],
 [[1,1],[1,1]],
 [[0,1,0],[1,1,1]]
];

const colors=["","#ff0044","#00ffff","#ff00ff"];

let player={pos:{x:5,y:0},matrix:null,color:1};

function collide(arena,player){
  for(let y=0;y<player.matrix.length;y++)
    for(let x=0;x<player.matrix[y].length;x++)
      if(player.matrix[y][x] &&
         (arena[y+player.pos.y] &&
          arena[y+player.pos.y][x+player.pos.x])!==0)
        return true;
  return false;
}

function merge(){
  player.matrix.forEach((row,y)=>{
    row.forEach((v,x)=>{
      if(v) arena[y+player.pos.y][x+player.pos.x]=player.color;
    });
  });
}

function drawMatrix(matrix,offset,color){
  matrix.forEach((row,y)=>{
    row.forEach((v,x)=>{
      if(v){
        ctx.fillStyle=colors[color];
        ctx.fillRect(x+offset.x,y+offset.y,1,1);
      }
    });
  });
}

function draw(){
  ctx.fillStyle="#000";
  ctx.fillRect(0,0,12,20);
  drawMatrix(arena,{x:0,y:0},1);
  drawMatrix(player.matrix,player.pos,player.color);
}

function drop(){
  player.pos.y++;
  if(collide(arena,player)){
    player.pos.y--;
    merge();
    reset();
  }
}

function move(dir){
  player.pos.x+=dir;
  if(collide(arena,player)) player.pos.x-=dir;
}

function rotate(){
  player.matrix = player.matrix[0].map((_,i)=>player.matrix.map(r=>r[i]).reverse());
  if(collide(arena,player))
    player.matrix = player.matrix[0].map((_,i)=>player.matrix.map(r=>r[r.length-1-i]));
}

function reset(){
  player.matrix = pieces[Math.floor(Math.random()*pieces.length)];
  player.color = Math.floor(Math.random()*3)+1;
  player.pos={x:5,y:0};
  if(collide(arena,player)){
    arena.forEach(r=>r.fill(0));
  }
}

setInterval(()=>{drop();draw();},600);
reset();
</script>
</body>
</html>
